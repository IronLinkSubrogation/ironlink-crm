<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Clients Dashboard</title>
</head>
<body>
  <h1>Registered Clients</h1>

  <input type="text" id="search" placeholder="Search by client name..." />
  <ul id="clients-list"></ul>

  <script>
    let allClients = [];

    // Fetch clients data from the backend
    fetch('/clients')
      .then(response => response.json())
      .then(data => {
        allClients = data;
        displayClients(data);
      });

    // Render client list with clickable names
    function displayClients(clients) {
      const list = document.getElementById('clients-list');
      list.innerHTML = '';
      clients.forEach(client => {
        const item = document.createElement('li');
        item.innerHTML = `
          <strong>
            <a href="/client-profile.html?name=${encodeURIComponent(client.name)}">
              ${client.name}
            </a>
          </strong><br>
          📧 ${client.contactEmail}<br>
          📞 ${client.contactPhone}<br>
          👤 Account Manager: ${client.accountManager}<br>
          📅 Joined: ${new Date(client.joinedOn).toLocaleDateString()}
          <hr>
        `;
        list.appendChild(item);
      });
    }

    // Live client name search
    document.getElementById('search').addEventListener('input', (e) => {
      const query = e.target.value.toLowerCase();
      const filtered = allClients.filter(client =>
        client.name.toLowerCase().includes(query)
      );
      displayClients(filtered);
    });
  </script>
</body>
</html>
