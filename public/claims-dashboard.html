<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Claims Dashboard</title>
</head>
<body>
  <h1>Submitted Claims</h1>

  <label>Filter by Client:</label><br>
  <select id="client-filter">
    <option value="">All Clients</option>
  </select>
  <ul id="claims-list"></ul>

  <script>
    let allClaims = [];

    // Load client names into dropdown
    fetch('/clients')
      .then(res => res.json())
      .then(clients => {
        const filter = document.getElementById('client-filter');
        clients.forEach(c => {
          const option = document.createElement('option');
          option.value = c.name;
          option.textContent = c.name;
          filter.appendChild(option);
        });
      });

    // Load all claims
    fetch('/data/claims.json')
      .then(res => res.json())
      .then(data => {
        allClaims = data;
        displayClaims(data);
      });

    // Filter claims on dropdown change
    document.getElementById('client-filter').addEventListener('change', (e) => {
      const selected = e.target.value.toLowerCase();
      const filtered = selected
        ? allClaims.filter(c => c.client.toLowerCase() === selected)
        : allClaims;
      displayClaims(filtered);
    });

    // Render claims list
    function displayClaims(claims) {
      const list = document.getElementById('claims-list');
      list.innerHTML = '';
      claims.forEach(claim => {
        const item = document.createElement('li');
        item.innerHTML = `
          ğŸ“ <strong>Claim #${claim.claimNumber}</strong><br>
          ${claim.description}<br>
          ğŸ“¤ Submitted by: ${claim.client}<br>
          ğŸ“… Date: ${new Date(claim.submittedAt).toLocaleDateString()}
          <hr>
        `;
        list.appendChild(item);
      });
    }
  </script>
</body>
</html>
